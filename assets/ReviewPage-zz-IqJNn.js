import{j as e}from"./vendor-ui-BuuLDXGn.js";import{a as r}from"./vendor-react-ChnU68HB.js";import{C as s,b as t,c as o,a}from"./card-BcwQM_-b.js";import{J as n,c as i}from"./vendor-icons-DLa0eLQi.js";function d({children:r,variant:s="secondary",size:t="md",fullWidth:o=!1,disabled:a=!1,className:n="",...i}){const d=o?"w-full":"";return e.jsx("button",{className:`inline-flex items-center justify-center font-medium rounded transition-all focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-ring disabled:opacity-40 disabled:cursor-not-allowed ${{primary:"bg-primary text-primary-foreground hover:bg-primary-hover border border-primary",secondary:"bg-secondary text-secondary-foreground hover:bg-background-tertiary border border-border",ghost:"bg-transparent text-foreground-secondary hover:bg-background-secondary border border-transparent",outline:"bg-transparent text-foreground border-2 border-border hover:bg-background-secondary",danger:"bg-severity-high text-severity-high-foreground hover:bg-severity-critical border border-severity-high"}[s]} ${{sm:"px-3 py-1.5 text-xs gap-1.5",md:"px-4 py-2 text-sm gap-2",lg:"px-6 py-3 text-base gap-2"}[t]} ${d} ${n}`,disabled:a,...i,children:r})}function c({auditLog:c,district:l,riskScoreId:u,onSubmit:m}){const[x,f]=r.useState(!1),[g,p]=r.useState(""),[h,b]=r.useState(""),[v,y]=r.useState("SP"),[j,N]=r.useState(!1);return e.jsxs(s,{children:[e.jsx(t,{children:e.jsx(o,{children:"Officer Review"})}),e.jsxs(a,{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"officer-rank",className:"block text-sm font-medium text-foreground",children:"Rank"}),e.jsxs("select",{id:"officer-rank",value:v,onChange:e=>y(e.target.value),className:"w-full px-4 py-2 bg-input-background border border-input-border rounded text-foreground focus:outline-none focus:ring-2 focus:ring-input-focus focus:border-input-focus",children:[e.jsx("option",{value:"SP",children:"SP"}),e.jsx("option",{value:"DSP",children:"DSP"}),e.jsx("option",{value:"DM",children:"DM"}),e.jsx("option",{value:"ADM",children:"ADM"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"officer-name",className:"block text-sm font-medium text-foreground",children:"Name"}),e.jsx("input",{type:"text",id:"officer-name",value:h,onChange:e=>b(e.target.value),placeholder:"Officer Name",className:"w-full px-4 py-2 bg-input-background border border-input-border rounded text-foreground placeholder:text-foreground-tertiary focus:outline-none focus:ring-2 focus:ring-input-focus focus:border-input-focus"})]})]}),e.jsxs("div",{className:"flex items-start gap-3 p-4 bg-background-secondary rounded border border-border",children:[e.jsx("input",{type:"checkbox",id:"officer-review",checked:x,onChange:()=>{f(!x)},className:"mt-1 w-4 h-4 rounded border-border bg-input-background accent-primary cursor-pointer"}),e.jsxs("label",{htmlFor:"officer-review",className:"flex-1 cursor-pointer",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-foreground font-medium",children:"Reviewed by Authorized Officer"}),x&&e.jsx(n,{className:"w-4 h-4 text-severity-low"})]}),e.jsx("p",{className:"text-sm text-foreground-secondary mt-1",children:"I confirm that I have reviewed the risk assessment and suggested actions"})]})]}),e.jsxs("div",{className:"bg-background-tertiary p-3 rounded border border-border-secondary grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-xs font-medium text-foreground-secondary uppercase tracking-wider",children:"Review ID"}),e.jsxs("div",{className:"font-mono text-sm text-foreground",children:["RVW-",(new Date).toISOString().slice(0,10).replace(/-/g,""),"-",Math.floor(1e3*Math.random()).toString().padStart(4,"0")]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-xs font-medium text-foreground-secondary uppercase tracking-wider",children:"Timestamp"}),e.jsx("div",{className:"font-mono text-sm text-foreground",children:(new Date).toLocaleString("en-IN")})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"officer-notes",className:"block text-sm font-medium text-foreground",children:"Review Notes"}),e.jsx("textarea",{id:"officer-notes",value:g,onChange:e=>p(e.target.value),rows:4,placeholder:"Enter review comments, decisions taken, or additional observations...",className:"w-full px-4 py-3 bg-input-background border border-input-border rounded text-foreground placeholder:text-foreground-tertiary focus:outline-none focus:ring-2 focus:ring-input-focus focus:border-input-focus resize-none"}),e.jsx("p",{className:"text-xs text-foreground-tertiary",children:"These notes will be included in the audit log along with the Review ID."})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(d,{variant:"primary",disabled:!x||!g.trim()||!h.trim()||j,onClick:async()=>{if(!m)return;N(!0);const e={district:l,risk_score_id:u,officer_name:h||"Officer",officer_rank:v,reviewed:x,notes:g,action_taken:g};await m(e)&&(p(""),f(!1)),N(!1)},children:j?"Submitting...":"Submit Review"}),e.jsx(d,{variant:"ghost",onClick:()=>{p(""),f(!1),b("")},disabled:j,children:"Clear"})]}),e.jsxs("div",{className:"pt-6 border-t border-border space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(i,{className:"w-4 h-4 text-foreground-secondary"}),e.jsx("h4",{className:"text-foreground",children:"Recent Audit Log"})]}),e.jsx("div",{className:"space-y-2 max-h-48 overflow-y-auto",children:c.length>0?c.map((r,s)=>e.jsxs("div",{className:"p-3 bg-background-secondary rounded border border-border-subtle text-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-4 mb-1",children:[e.jsx("span",{className:"text-foreground-secondary font-medium",children:r.officer}),e.jsx("span",{className:"text-xs text-foreground-tertiary",children:r.timestamp})]}),e.jsx("p",{className:"text-foreground-secondary",children:r.action})]},s)):e.jsx("p",{className:"text-sm text-foreground-tertiary text-center py-4",children:"No audit log entries yet"})})]})]})]})}function l({selectedDistrict:r,auditLog:s,onReviewSubmit:t}){const o=s.map(e=>({timestamp:new Date(e.timestamp).toLocaleString("en-IN"),officer:e.officer_name,action:e.action}));return e.jsxs("div",{className:"max-w-2xl mx-auto space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold tracking-tight text-foreground",children:"Officer Review"}),e.jsx("p",{className:"text-foreground-secondary mt-1",children:"Mandatory human review of algorithmic risk assessments."})]}),e.jsx(c,{district:r,riskScoreId:1,auditLog:o,onSubmit:t})]})}export{l as ReviewPage};
